(function(a){return a.fn.ajaxChosen=function(y,z){var b,v,u,i;b={minLength:3,queryLimit:10,delay:100,chosenOptions:{},searchingText:"Searching...",noresultsText:"No results."};a.extend(b,y);b.chosenOptions.no_results_text=b.searchingText;v=(u=this.attr("multiple")!=null)?".search-field > input":".chzn-search > input";i=this;this.chosen(b.chosenOptions);return this.next(".chzn-container").find(v).bind("keyup",function(){var w=this;this.previousSearch&&clearTimeout(this.previousSearch);return this.previousSearch=
setTimeout(function(){var q,j,d,r,m;d=a(w);m=a.trim(d.attr("value"));r=(q=d.data("prevVal"))!=null?q:"";d.data("prevVal",m);q=function(){return(u?d.parent().parent().siblings():d.parent().parent()).find(".no-results").html(b.noresultsText+" '"+a(w).attr("value")+"'")};if(m.length<b.minLength||m===r){q();return false}j=i.find("option");if(j.length<b.queryLimit&&m.indexOf(r)===0&&r!==""){q();return false}b.term=m;return z(b,function(s,x){var e,n,g,h,t;if(d.is(":focus")){n=[];a.each(s,function(o,f){var c;
c=a("<option>");c.attr("value",o).html(f);return n.push(a(c))});g=function(o){var f,c;f=a(o);if(!(f.attr("selected")&&u))if(function(){var k,l,p;p=[];k=0;for(l=n.length;k<l;k++){c=n[k];c.attr("value")===f.attr("value")&&p.push(c)}return p}().length===0)return f.remove()};h=0;for(t=j.length;h<t;h++){e=j[h];g(e)}j=i.find("option");g=function(o){var f,c,k,l,p;c=false;k=function(A){if(a(A).attr("value")===o.attr("value"))return c=true};l=0;for(p=j.length;l<p;l++){f=j[l];k(f)}if(!c)return i.append(o)};
h=0;for(t=n.length;h<t;h++){e=n[h];g(e)}e=d.val();if(a.isEmptyObject(s)){g=a("<option>");g.addClass("no-results");g.html(b.noresultsText+" '"+e+"'").attr("value","");i.append(g)}else i.change();i.trigger("liszt:updated");a(".no-results").removeClass("active-result");d.val(e);if(!a.isEmptyObject(s)){e=a.Event("keydown");e.which=40;d.trigger(e)}if(x)return x(s)}})},b.delay)})}})(jQuery);
